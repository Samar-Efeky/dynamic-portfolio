<!-- Form -->
<form [formGroup]="form" class="min-h-screen w-full bg-black text-white lg:px-6 md:px-4 px-2 py-6 flex justify-center items-start">

  <div class="w-full py-10 lg:px-6 md:px-4 px-2 rounded-[7px] shadow-xl" style="background-color: var(--sectionColor);">

    <h2 class="lg:text-[1.7rem] md:text-[1.5rem] text-[1.3rem] font-bold mb-10 span-color">
      Personal Information
    </h2>

    <!-- Inputs Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-4">

      <!-- Full Name -->
      <div>
        <label class="block mb-2 font-semibold">Full Name (two words)</label>
        <input type="text" formControlName="fullName"
               class="w-full p-3 form-control mb-4"
               placeholder="Full Name" />
      </div>

      <!-- Username -->
      <div>
        <label class="block mb-2 font-semibold">Username (one word)</label>
        <input type="text" formControlName="username"
               class="w-full p-3 form-control mb-4"
               placeholder="Username" />
          <div *ngIf="
      form.get('username')?.touched &&
      form.get('username')?.errors?.['usernameTaken'] &&
      form.get('username')?.value !== currentUsername
    "
    class="text-red-900 bg-200 p-2 rounded-sm text-sm mt-1">
    Username already taken!
  </div>       
      </div>

      <!-- Email -->
      <div>
        <label class="block mb-2 font-semibold">Email</label>
        <input type="text" formControlName="email"
               class="w-full p-3 form-control mb-4"
               placeholder="Email" />
      </div>

      <!-- Phone -->
      <div>
        <label class="block mb-2 font-semibold">Phone</label>
        <input type="text" formControlName="phone"
               class="w-full p-3 form-control mb-4"
               placeholder="Phone" />
      </div>

      <!-- Location -->
      <div>
        <label class="block mb-2 font-semibold">Location</label>
        <input type="text" formControlName="location"
               class="w-full p-3 form-control mb-4"
               placeholder="Location" />
      </div>

      <!-- Main Job Title -->
      <div>
        <label class="block mb-2 font-semibold">Main Job Title (3 words)</label>
        <input type="text" formControlName="mainJobTitle"
               class="w-full p-3 form-control mb-4"
               placeholder="Web Developer" />
      </div>

    </div>

    <!-- Related Job Titles -->
    <label class="block mb-2 font-semibold">Related Job Titles (Max 5 & Min 4)</label>
    <div class="flex items-center gap-3 mb-3">
      <input #relatedInput type="text"
             (keydown.enter)="$event.preventDefault(); addRelatedJobTitle(relatedInput.value); relatedInput.value='';"
             class="flex-1 p-3 form-control focus:outline-none focus:ring-2 focus:ring-main"
             placeholder="e.g. Web Developer, UI Designer" />
    <button type="button"
        [disabled]="relatedJobTitlesArray.length >= 5"
        (click)="addRelatedJobTitle(relatedInput.value); relatedInput.value='';"
        class="px-4 py-2 no-after-button">
  Add
</button>

    </div>

    <div class="flex flex-wrap gap-2 mb-4">
      <ng-container *ngFor="let titleCtrl of relatedJobTitlesArray.controls; let i = index">
        <span class="px-3 py-2 rounded-[3px] flex items-center gap-2 text-sm"
              style="background-color: var(--inputColor);">
          <span class="whitespace-nowrap">{{ titleCtrl.value }}</span>
          <button type="button" (click)="removeRelatedJobTitle(i)"
                  class="ml-1 no-after-button rounded-[3px] px-1">
            <i class="fa-solid fa-xmark text-[12px]"></i>
          </button>
        </span>
      </ng-container>
    </div>

    <!-- Profile Image -->
    <label class="block mb-2 font-semibold">Profile Image</label>
    <input type="file"
           class="w-full p-3 form-control mb-10"
           (change)="uploadImage($event)" />
    <div class="mb-10" *ngIf="profileImagePreview">
      <img [src]="profileImagePreview"
           class="w-[200px]  object-cover "
           alt="Profile Preview" />
    </div>
<!-- Social Media Links -->
<label class="block mb-2 font-semibold">Social Media Links (Min 3 links)</label>

<!-- Container -->
<div class=" flex flex-col gap-3 mb-6 w-full md:flex-row md:items-center">

  <!-- Platform Select -->
  <select #platformSel
          class="social-options w-full md:w-1/3 p-3 rounded focus:outline-none focus:ring-2 focus:ring-main">
    <option value="LinkedIn">LinkedIn</option>
    <option value="GitHub">GitHub</option>
    <option value="Facebook">Facebook</option>
    <option value="Twitter">Twitter</option>
    <option value="Instagram">Instagram</option>
  </select>

  <!-- URL Input -->
 <div class="flex w-full">
   <input #urlInput type="text"
         class="w-full md:flex-1 px-3  form-control"
         placeholder="https://linkedin.com/in/username" />

  <!-- Add Button -->
  <button type="button"
          (click)="addSocial(platformSel.value, urlInput.value); urlInput.value='';"
          class=" px-3  no-after-button ">
    Add
  </button>
 </div>

</div>



<!-- List of Added Social Links -->
<ul class="space-y-2 mt-4 w-full">
  <ng-container *ngFor="let s of socialLinksArray.controls; let i = index">
    <li class="flex justify-between items-center p-3 rounded-lg w-full"
        style="background-color: var(--inputColor);">
      <div class="truncate">
        <strong class="text-main mr-2 span-color ">{{ s.value.platform }}:</strong>
        <a [href]="s.value.url" target="_blank" class="underline block truncate pt-2">
          {{ s.value.url }}
        </a>
      </div>
      <button type="button"
              class="ml-4 px-1 rounded-[3px] no-after-button"
              (click)="removeSocial(i)">
        <i class="fa-solid fa-xmark text-[12px]"></i>
      </button>
    </li>
  </ng-container>
</ul>

    <!-- Save Button -->
    <div class="mt-6 flex justify-end">
      <button type="button"
        (click)="saveData()"
        [disabled]="form.invalid"
        class="px-5 py-3 text-black font-semibold mt-5 ">
  Save Data
</button>
    </div>

  </div>

</form>
